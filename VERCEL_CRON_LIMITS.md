# Лимиты Vercel Cron Jobs

## ⚠️ Важно: Ограничения по планам

### Hobby план (бесплатный)

**Лимиты:**
- ✅ 2 cron jobs на аккаунт
- ✅ Только **1 раз в день** (нельзя чаще!)
- ⚠️ **Нет гарантии точного времени** выполнения
  - Например, cron `0 1 * * *` (каждый день в 1:00) может выполниться в любое время между 1:00 и 1:59

**Проблема для Telegram бота:**
- Telegram бот настроен на отправку карточек **каждый час** (`0 * * * *`)
- На Hobby плане это **невозможно** - можно только раз в день

**Решения для Hobby плана:**

#### Вариант 1: Использовать GitHub Actions (рекомендуется)

GitHub Actions позволяет запускать cron jobs каждые 5 минут бесплатно!

1. Уже настроен файл `.github/workflows/telegram-cron.yml`
2. Просто добавьте секреты в GitHub:
   - Settings → Secrets and variables → Actions
   - Добавьте:
     - `APP_URL` - URL вашего Vercel приложения
     - `TELEGRAM_CRON_SECRET` - секретный ключ

3. Удалите cron из `vercel.json` (или оставьте для Pro плана)

#### Вариант 2: Изменить расписание на раз в день

Измените `vercel.json`:

```json
{
  "crons": [
    {
      "path": "/api/telegram/send-cards",
      "schedule": "0 9 * * *"  // Каждый день в 9:00
    }
  ]
}
```

#### Вариант 3: Использовать внешний сервис

- [cron-job.org](https://cron-job.org) - бесплатно, до 2 cron jobs
- [EasyCron](https://www.easycron.com) - бесплатно, ограниченные функции

---

### Pro план ($20/месяц)

**Лимиты:**
- ✅ 40 cron jobs на аккаунт
- ✅ **Неограниченные вызовы**
- ✅ **Точное время выполнения**
- ✅ До 20 cron jobs на проект

**Идеально для Telegram бота:**
- Можно настроить отправку каждый час
- Гарантированное время выполнения
- Неограниченное количество вызовов

---

### Enterprise план

**Лимиты:**
- ✅ 100 cron jobs на аккаунт
- ✅ Неограниченные вызовы
- ✅ Точное время выполнения
- ✅ До 20 cron jobs на проект

---

## Текущая конфигурация

В `vercel.json` настроен cron job:

```json
{
  "crons": [
    {
      "path": "/api/telegram/send-cards",
      "schedule": "0 * * * *"  // Каждый час
    }
  ]
}
```

**⚠️ Это НЕ будет работать на Hobby плане!**

---

## Рекомендации

### Для Hobby плана (бесплатно):

1. **Используйте GitHub Actions** (уже настроено):
   - Откройте `.github/workflows/telegram-cron.yml`
   - Добавьте секреты в GitHub
   - Удалите или закомментируйте `crons` из `vercel.json`

2. **Или измените расписание на раз в день:**
   ```json
   "schedule": "0 9 * * *"  // Каждый день в 9:00
   ```

### Для Pro плана:

1. Оставьте текущую конфигурацию в `vercel.json`
2. Vercel автоматически настроит cron job
3. Проверьте в Dashboard → Settings → Cron Jobs

---

## Как проверить, какой план у вас

1. Откройте [Vercel Dashboard](https://vercel.com/dashboard)
2. Нажмите на ваш аккаунт (правый верхний угол)
3. Выберите "Settings" → "Billing"
4. Там будет указан ваш план

---

## Альтернативные решения

### 1. GitHub Actions (бесплатно, лучший вариант)

✅ Уже настроен в `.github/workflows/telegram-cron.yml`
✅ Бесплатно для публичных репозиториев
✅ Можно запускать каждые 5 минут
✅ Неограниченное количество workflow runs

**Настройка:**
1. GitHub → Settings → Secrets and variables → Actions
2. Добавьте секреты:
   - `APP_URL`: `https://your-app.vercel.app`
   - `TELEGRAM_CRON_SECRET`: ваш секретный ключ

### 2. Supabase Edge Functions + pg_cron

Если используете Supabase, можно настроить через базу данных.

### 3. Railway Cron Jobs

Railway предлагает cron jobs на всех планах.

---

## Сравнение вариантов

| Вариант | Стоимость | Частота | Точность | Сложность |
|---------|-----------|---------|----------|-----------|
| **GitHub Actions** | Бесплатно | Каждые 5 мин | ✅ Высокая | ⭐ Легко |
| **Vercel Hobby** | Бесплатно | 1 раз/день | ⚠️ Низкая | ⭐ Легко |
| **Vercel Pro** | $20/мес | Неограничено | ✅ Высокая | ⭐ Легко |
| **cron-job.org** | Бесплатно | Каждые 5 мин | ✅ Средняя | ⭐⭐ Средне |

---

## Рекомендация

**Для начала используйте GitHub Actions** - это бесплатно и работает отлично!

1. Удалите `crons` из `vercel.json` (или оставьте для будущего Pro плана)
2. Настройте секреты в GitHub
3. Готово! ✅

